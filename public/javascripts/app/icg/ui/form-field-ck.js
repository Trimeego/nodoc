((function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Object.prototype.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);e.prototype=c.prototype;a.prototype=new e;a.__super__=c.prototype;return a};define(["order!app/icg/namespace","order!vendor/underscore","order!vendor/backbone","app/icg/utils"],function(b,d,e){var f;f="<label class='field-label'></label><div class='field-value' />";return ICG.UI.FormField=function(b){function d(){this.render=a(this.render,this);this.focusOut=a(this.focusOut,this);this.getText=a(this.getText,this);this.change=a(this.change,this);d.__super__.constructor.apply(this,arguments)}c(d,b);d.prototype.className="form-field";d.prototype.tagName="div";d.prototype.events={"change input":"validate","keyup input":"change","keydown input":"validateKeyStroke","blur input":"focusOut","click input.radio-button":"selected","change select":"selected"};d.prototype.initialize=function(){var a;this.template=_.template(f);this.options&&this.options.validator&&(this.customValidator=this.options.validator);this.options&&this.options.value&&(this.internalValue=this.options.value);(a=this.options).type==null&&(a.type="text");switch(this.options.type){case"date":this.options&&this.options.value&&(this.internalValue=this.options.value);break;case"number":this.options&&this.options.value&&(this.internalValue=new Number(this.options.value))}return this.originalValue=this.internalValue};d.prototype.change=function(a){this.options&&this.options.validateOnKeyStroke===!0&&this.validate(null)&&this.trigger("validChange",this);return this.trigger("change")};d.prototype.getText=function(){return this.$(".field-value-element").val()};d.prototype.focusOut=function(a){this.internalValue=this.$(".field-value-element").val();if(this.validate(this.$(".field-value-element").val())){this.internalValue=this.$(".field-value-element").val();this.options.value=this.internalValue;return this.trigger("validChange",this)}};d.prototype.formattedValue=function(){var a;a=this.internalValue;switch(this.options.type){case"date":a=ICG.Utils.Date.dateFormat(this.internalValue,"mm/dd/yyyy");break;case"number":a=ICG.Utils.Number.formatNumber(this.internalValue-0);break;case"money":a=ICG.Utils.Number.formatMoney(this.internalValue)}return a};d.prototype.render=function(){var a,b,c,d,e,f,g;e=this.template(this.options);c=$(this.el);c.html(e);this.options.css&&this.$el.addClass(this.options.css);this.options.type&&this.$el.addClass(this.options.type);this.options.dataField&&this.$el.addClass(this.options.dataField);this.options.label&&this.$("label").append(this.options.label);if(!this.options.readOnly)if(this.options.list){a=$("<select />");d=0;while(d<this.options.list.length){b=$("<option>");b.attr("value",this.options.list[d].value);this.options.value&&this.options.value===this.options.list[d].value&&b.attr("selected","true");b.append(this.options.list[d].label);a.append(b);d++}}else{a=$("<input />");a.attr("type",(g=(f=this.options).type)!=null?g:f.type="text");this.options.type==="date"&&a.attr("placeholder","MM/DD/YYYY");this.internalValue!==null&&a.attr("value",this.formattedValue())}else{a=$("<div />");a.append(this.formattedValue())}this.options.type==="date"?a.attr("maxlength","10"):this.options.maxLength&&a.attr("maxlength",this.options.maxLength);a.addClass("field-value-element");this.$(".field-value").append(a);return this};d.prototype.reset=function(){return this.val(this.originalValue)};d.prototype.selected=function(a){};d.prototype.set=function(a){return this.val(a)};d.prototype.val=function(a){var b;a!==void 0&&(this.internalValue=a);if(a!==void 0){this.internalValue=a;this.render()}else{b=this.internalValue;if(this.options.list&&this.options.list.length>0){b=this.$(".field-value-element").val();this.internalValue=b}switch(this.options.type){case"date":b=new Date(Date.parse(this.internalValue));break;case"number":case"money":b=new Number(this.internalValue.replace("$","").replace(",",""))}}return b};d.prototype.value=function(a){return this.val(a)};d.prototype.validate=function(a){var b;b=!0;$(this.el).removeClass("error");if(this.getText()!==""){switch(this.options.type){case"date":b=ICG.Utils.Date.isDate(this.getText())}b!==!0&&$(this.el).addClass("error")}b===!0&&!this.options.readOnly&&this.options.required&&this.getText()===""&&$(this.el).removeClass("error");return b};d.prototype.validateKeyStroke=function(a){var b,c;b=!0;c=a.keyCode;if(c!==8&&c!==9&&c!==37&&c!==39){if(this.options.type==="money"||this.options.type==="number")b=a.keyCode===110||a.keyCode===190||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105;this.options.type==="date"&&(b=a.keyCode===191||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105)}return b};return d}(Backbone.View)})})).call(this);